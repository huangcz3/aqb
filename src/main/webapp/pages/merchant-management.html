<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>商家管理</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta name="author" content="zhy" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/pulbic.css">
    <link rel="stylesheet" href="../css/merchant-management.css">
</head>
<body>
<header role="banner"></header>
<nav role="navigation">
    <nav role="navigation">
        <!-- Contenedor -->
        <ul id="accordion" class="accordion">
            <li>
                <div class="link"><i class="fa fa-globe"></i>设备管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./binding-reviewed.html">设备绑定审核</a></li>
                    <li><a href="./unbundling.html">设备解绑</a></li>
                    <li><a href="./binding.html">在线设备查询</a></li>
                </ul>
            </li>
            <li>
                <div class="link"><i class="fa fa-globe"></i>红包提现审核<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./withdrawals.html">提现审核</a></li>
                </ul>
            </li>
            <li>
                <div class="link"><i class="fa fa-globe"></i>广告管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./advertisement.html">广告内容审核</a></li>
                    <li><a href="./order-list.html">广告内容列表</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>修车圈管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./repair-examine.html">用户评价审核</a></li>
                    <li><a href="./repair-administration.html">用户评价管理</a></li>
                    <li><a href="./merchant-management.html">商家管理</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>押金管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./deposit.html">押金管理</a></li>
                    <li class="active"><a href="./deposit-retreat.html">押金退还审核</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>弹幕管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./barrage.html">弹幕管理</a></li>
                    <li><a href="./topic.html">话题编辑</a></li>
                    <li><a href="./circle.html">大小圈金额</a></li>
                    <li><a href="./vip.html">VIP权限设置</a></li>
                    <li><a href="./keyword.html">关键词屏蔽</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>结算与分成管理<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./exchange.html">兑换比例设置</a></li>
                    <li><a href="./commission.html">车主分成比例设置</a></li>
                    <li><a href="./referee.html">推荐人奖励</a></li>
                    <li><a href="./timePrice.html#成都">时段价格设置</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>其他设置<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./integral.html">积分任务管理</a></li>
                    <li><a href="./share.html">邀请分享设置</a></li>
                    <li><a href="./pop-ads.html">弹窗广告设置</a></li>
                    <li><a href="./insurance.html">保险</a></li>
                    <li><a href="./setting.html">其他设置</a></li>
                </ul>
            </li>
            <li><div class="link"><i class="fa fa-globe"></i>系统设置<i class="fa fa-chevron-down"></i></div>
                <ul class="submenu">
                    <li><a href="./staff.html">员工权限设置</a></li>
                    <li><a href="./privacy.html">隐私保护</a></li>
                </ul>
            </li>
        </ul>
    </nav>
</nav>
<main role="main">
    <h3>商家管理</h3>
    <table class="table table-striped table-bordered table-hover table-condensed">
        <thead>
            <div class="set-upTitle">
                <div class="set-upTitleBox after">
                    <p class="set-upBtns mer-add">
                        新增
                    </p>
                    <p class="set-upBtns mer-modify"  name="2">
                       修改
                    </p>
                    <p class="set-upBtns delect">
                        删除
                    </p>
                </div>
            </div>
            <tr>
                <th>选择</th>
                <th>商家名称</th>
                <th>商家类型</th>
                <th>商家地理位置</th>
                <th>商家电话</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <footer>
        <!--分页-->
        <div class="pagingBox">
            <div class="paging">
                <span class="pageTotal">共条</span>
                <span class="pagingLine"></span>
                <span class="pageHome" >首页</span>
                <span class="pagingLine"></span>
                <span class="pageUpper" >上一页</span>
                <span class="pagingLine"></span>
                <span class="pageFirst">第<span id="pageFirstCont"></span>页</span>
                <span class="pagingLine"></span>
                <span class="pageNext" >下一页</span>
                <span class="pagingLine"></span>
                <span class="pageCount">共页</span>
                <span class="pagingLine"></span>
                <span class="pageJump">跳转至</span>
                <input type="number" maxlength="3" min="0" class="pagingInput" name=""/>
                <span class="pagBtn">Go</span>
            </div>
        </div>
    </footer>
    <!--弹窗-->
    <div class="error">
        你好，操作有误！
    </div>
</main>
<!--弹窗-->
<div class="merchant-promptBox">
    <div class="merchant-prompt">
        <p class="merchant-title">
            新增商家
        </p>
        <div class="merchantBox after">
            <div class="merchant after">
                <p class="merchant-p">
                    商家名称：
                </p>
                <p class="merchant-input">
                    <input type="text" value="" placeholder="请输入商家名称" class="userName">
                </p>

            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家电话：
                </p>
                <p class="merchant-input">
                    <input type="text" value="" placeholder="请输入商家电话" class="userPhone">
                </p>
            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家地址信息：
                </p>
                <p class="merchant-input">
                    <input type="text" placeholder="" disabled class="repairAddress">
                </p>
            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家经纬度：
                </p>
                <p class="merchant-input">
                  <span class="repairLongitude">15.6525.  </span> <span class="repairLatitude">1251465</span>   <button class="modify merchant-modify">修改</button>
                </p>
            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家介绍：
                </p>
                <p class="merchant-input">
                    <textarea name=""  placeholder="请输入商家介绍" class="merchant-text" ></textarea>
                </p>
            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家类型：
                </p>
                <p class="merchant-input">
                    <label>
                        <input type="checkbox" value="1" name="typeStatus" class="repair">修车
                    </label>
                    <label>
                        <input type="checkbox" value="2" name="typeStatus" class="maintain">保养
                    </label>
                    <label>
                        <input type="checkbox" value="3" name="typeStatus" class="car-wash">洗车
                    </label>
                </p>
            </div>
            <div class="merchant after">
                <p class="merchant-p">
                    商家封面：
                </p>
                <div class="merchant-input merchant-file">
                    <img src="" alt="" class="merchant-img">
                    <input type="file" id="" class="fileInput" onclick="fileToUpload(this)">
                </div>
            </div>
            <p class="mer-error">
                &nbsp
            </p>
            <div class="merchant merchant-btns">
                <button class="cancel">关闭</button>
                <button class="pass merchant-pass">提交</button>
            </div>

        </div>
        <!--地图-->
        <div id="mapCont">

        </div>
        <div id="r-result" class="after">
            <p class="map-p1">
               经度<input type="text" name="lng" id="lng" value="" readonly placeholder="请点击地图获取经度"/>
            </p>
            <p class="map-p2">
                纬度<input type="text" name="lat" id="lat" value="" readonly placeholder="请点击地图获取纬度度"/>
            </p>
            <div class="map-divBox">
                    地址: <input id="sever_add" type="text" value=""/>
                    <input type="button" class="qurey"  value="查询" onclick="theLocation()" />
                    <input type="button" class="pass map-pass"  value="确定" style="margin-left: 30px" />
            </div>
            <p class="preview-picturesClone">
                <img src="../images/icon.png" alt="">
            </p>
        </div>
    </div>
</div>
<script src="../js/jquery.min.js"></script>
<script src="http://api.map.baidu.com/api?v=2.0&ak=s2gom8yBIFaLcj4i1CUCC3FUuSAU15RB"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../H5/js/auto-size.js"></script>
<script src="../js/paging.js"></script>
<script src="../js/ajaxfileupload.js"></script>
<script src="../js/merchant-management.js"></script>
<script>
    var map = new BMap.Map("mapCont");
    var point = new BMap.Point(104.750946,30.197633);
    map.centerAndZoom(point, 13); // 中心点
    var markersArray = [];
    var geolocation = new BMap.Geolocation();//缩放
    map.addEventListener("click", showInfo);//点击地图调用的事件
    var geoc = new BMap.Geocoder();   //地址解析对象
    var local = new BMap.LocalSearch(map, {
        renderOptions:{map: map}
    });
    //清除标识
    function clearOverlays() {
        if (markersArray) {
            for (i in markersArray) {
                map.removeOverlay(markersArray[i])
            }
        }
    }
    //地图上标注
    function addMarker(point) {
        var marker = new BMap.Marker(point);
        markersArray.push(marker);
        clearOverlays();
        map.addOverlay(marker);
    }
    //缩放
    geolocation.getCurrentPosition(function (r) {
        if (this.getStatus() == BMAP_STATUS_SUCCESS) {
            var mk = new BMap.Marker(r.point);
            map.addOverlay(mk);
            map.panTo(r.point);
            map.enableScrollWheelZoom(true);
        }
        else {
            alert('failed' + this.getStatus());
        }
    }, {enableHighAccuracy: true})
    //点击地图事件处理
    function showInfo(e) {
        $("#lng").val(e.point.lng);
        $("#lat").val(e.point.lat);
        geoc.getLocation(e.point, function (rs) {
            var addComp = rs.addressComponents;
            var address = addComp.province + addComp.city + addComp.district + addComp.street + addComp.streetNumber;
            $("#sever_add").val(address)
        });
        addMarker(e.point);
    }
    //    根据输入地址查询
    function theLocation(){
        var city = $("#sever_add").val();
        console.log(city)
        if(city != ""){
            local.search(city);
        }
    }
    // 上传图片
    function fileToUpload(obj){
        var obj=$(obj);
        var objId;
        var flag;
        flag= obj.prev();
        obj.change(function(){
            console.log(objId);
            console.log(obj.attr("id"));
            $.ajaxFileUpload({
                url:'../api/repair/uploadCover',
                dataType: 'json',
                secureuri:false,
//                data:{
//                    id:obj.attr("id")
//                },
                fileElementId:obj.attr("id"),//file标签的id
                success: function (data) {
//                    var datas = jQuery.parseJSON(data.body);
                    flag.attr("src", data.body);
                    flag.attr("alt", "1");
                },error:function (data) {
//                    var datas = jQuery.parseJSON(data.body);
                    flag.attr("src", data.responseText.body);
                    flag.attr("alt", "1");
                    console.log(data)
                }
            });
        })
    };
</script>

</body>
</html>